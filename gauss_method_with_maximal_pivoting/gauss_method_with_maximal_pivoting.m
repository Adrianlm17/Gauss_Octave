## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
## -----------------------------------------                                                                                                -----------------------------------------
## -----------------------------------------                               Gauss method With Maximal Pivoting                               -----------------------------------------
## -----------------------------------------                                                                                                -----------------------------------------
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



clc;



y = 0.3000;
z = 27;
s = 2307;
t = 12983;
x = 0.0001;

A = [
    x^4, x^3, x^2, x^1, 1;
    y^4, y^3, y^2, y^1, 1;
    z^4, z^3, z^2, z^1, 1;
    s^4, s^3, s^2, s^1, 1;
    t^4, t^3, t^2, t^1, 1
];

A = (A');
b = [1; 2; 3; 4; 5];



function [results, A, b] = gauss_method_with_maximal_pivoting(A, b)
    results = "";
    [n, m] = size(A);

    for j = 1:n-1
        mx = j;
        for i = j + 1:n
            if abs(A(i, j)) > abs(A(mx, j))
                mx = i;
            endif
        endfor

        if mx != j
            A([j, mx], :) = A([mx, j], :);
            b([j, mx]) = b([mx, j]);
        endif

        for i = j + 1:n
            m = A(i, j) / A(j, j);
            A(i, j) = 0;
            for k = j + 1:n
                A(i, k) = A(i, k) - m * A(j, k);
            endfor
            b(i) = b(i) - m * b(j);
        endfor
    endfor

    x = zeros(n, 1);
    for i = n:-1:1
        x(i) = (b(i) - A(i, i+1:n) * x(i+1:n)) / A(i, i);
    endfor

    for i = 1:length(x)
        results = [results, sprintf("Î»%d = %.25f\n", i, x(i))];
    endfor
endfunction



[results, A, b] = gauss_method_with_maximal_pivoting(A, b);



disp('Matrix A after elimination:');
disp(A);
disp('Vector B after removal:');
disp(b);
disp('Result of the unknowns:');
disp(results);

